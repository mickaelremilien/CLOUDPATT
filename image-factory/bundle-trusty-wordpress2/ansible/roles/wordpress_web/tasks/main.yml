---
    - name: packages installed
      apt:
        pkg={{ item }}
        state=present
      with_items:
        - apache2
        - wordpress

    - name: apache site configuration
      copy:
        src=role/wordpress_web/files/wordpress.apache2.conf
        dest=/etc/apache2/sites-available/default-wp.conf
        owner=root
        group=root
        mode=0644
      notify: enable apache site

    - name: wordpress site configuration
      template:
        src=role/wordpress_web/files/wordpress.etc.conf
        dest=/etc/wordpress/config-default.php
        owner=root
        group=root
        mode=0644

    - name: wordpress content has correct ownership
      file:
        path="{{ item }}"
        state=directory
        owner=www-data
        group=www-data
        recurse=yes
      with_items:
        - /var/lib/wordpress/wp-content
        - /usr/share/wordpress/wp-content

    - name: Rewrite module activated
      apache2_module:
        name=rewrite
        state=present

    - name: apache service started
      service: name=apache2 state=started enabled=yes

  
